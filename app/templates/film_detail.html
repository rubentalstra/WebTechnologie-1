{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>{{ film.titel }}</h2>
        <div>
            <!-- Edit button -->
            {% if current_user.is_authenticated %}
            <a href="{{ url_for('main.edit_film', id=film.id) }}" class="btn btn-primary me-2">Edit Film</a>
            {% endif %}

            <!-- Delete button -->
            {% if current_user.is_authenticated %}
            <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteConfirmationModal"
                data-film-id="{{ film.id }}">Delete Film</button>
            {% endif %}
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <p><strong>Regisseur:</strong> {{ film.regisseur.voornaam }} {{ film.regisseur.achternaam }}</p>
            <p><strong>Jaar:</strong> {{ film.jaar }}</p>
            <p><strong>Bezoekers:</strong> {{ film.bezoekers }}</p>
            <p><strong>Omzet:</strong> {{ film.omzet }}</p>
            <p><strong>Overzicht:</strong> {{ film.overzicht }}</p>
            <p><strong>Trailer URL:</strong> <a href="{{ film.trailer_url }}" target="_blank">{{ film.trailer_url }}</a>
            </p>
        </div>
        <div class="col-md-4">
            <!-- If you have an image or poster for the film, you can display it here -->
            {% if film.poster_url %}
            <img src="{{ film.poster_url }}" class="img-fluid rounded" alt="Film Poster">
            {% endif %}
        </div>
    </div>
</div>

<!-- Quotes Section -->
<div class="container mt-4">
    <h3>Citaat</h3>
    {% for quote in quotes %}
    <blockquote class="blockquote">
        <p class="mb-0">{{ quote.inhoud }}</p>
    </blockquote>
    {% else %}
    <p>No quotes yet.</p>
    {% endfor %}

    <!-- Add Quote Form -->
    {% if current_user.is_authenticated %}
    <h4>Add a new Citaat</h4>

    {% include 'flash_messages_template.html' %}


    <form action="" method="POST">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.inhoud.label }}
            {{ form.inhoud(class="form-control") }}
        </div>
        {{ form.submit(class="btn btn-primary") }}
    </form>
    {% endif %}
</div>


<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmationModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteConfirmationModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this Movie?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <a href="#" class="btn btn-danger" id="deleteFilmBtn">Delete</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        var deleteConfirmationModal = document.getElementById('deleteConfirmationModal')
        deleteConfirmationModal.addEventListener('show.bs.modal', function (event) {
            // Button that triggered the modal
            var button = event.relatedTarget
            // Extract info from data-* attributes
            var filmId = button.getAttribute('data-film-id')
            // Update the modal's delete button href
            var deleteButton = deleteConfirmationModal.querySelector('.modal-footer #deleteFilmBtn')
            deleteButton.href = `/film/delete/${filmId}`
        })
    });
</script>
{% endblock %}